#!/bin/sh
set -e

CHANGED_FILES=$(git diff --cached --name-only)

RUN_UI=false
RUN_SERVER=false

echo "$CHANGED_FILES" | grep -q '^apps/ui/' && RUN_UI=true
echo "$CHANGED_FILES" | grep -q '^apps/server/' && RUN_SERVER=true

if [ "$RUN_UI" = true ]; then
  echo "üîç Running UI lint and type-check..."
  pnpm --filter penny-app-ui lint
  pnpm --filter penny-app-ui type-check
fi

if [ "$RUN_SERVER" = true ]; then
  echo "üîç Running Server lint and type-check..."
  pnpm --filter penny-app-server lint
  pnpm --filter penny-app-server type-check
fi

if [ "$RUN_UI" = false ] && [ "$RUN_SERVER" = false ]; then
  echo "‚ÑπÔ∏è No UI or Server changes detected. Skipping checks."
fi
